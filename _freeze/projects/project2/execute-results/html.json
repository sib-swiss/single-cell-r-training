{
  "hash": "07f42d9a68094230d79f040ccd99036e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Project 2\"\nexecute:\n    eval: false\nproject:\n    execute-dir: project\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\nProject 2 focuses on a single-cell sequencing study of the Drosophila brain following acute cocaine exposure; [paper](https://genome.cshlp.org/content/31/10/1927.long). Flies were exposed to cocaine, which impaired locomotor activity and increased the incidence of seizures and compulsive grooming. To investigate the specific cell populations responding to cocaine, single-cell transcriptional responses were analyzed in duplicate samples of flies that consumed sucrose or sucrose supplemented with cocaine. The study utilized the 10x Genomics Chromium platform for single-cell RNA sequencing.\n\nUnsupervised clustering of transcriptional profiles from 86,224 cells revealed 36 distinct clusters, representing all major cell types (neuronal and glial) and neurotransmitter types from most brain regions. Differential expression analysis within individual clusters indicated cluster-specific responses to cocaine, with Kenyon cells of the mushroom bodies and glia showing particularly large transcriptional changes. The study highlighted profound sexual dimorphism in brain transcriptional responses to cocaine, with males exhibiting more pronounced changes than females.\n\nCluster-specific coexpression networks and global interaction networks revealed diverse cellular processes affected by acute cocaine exposure, providing an atlas of sexually dimorphic cocaine-modulated gene expression in the Drosophila brain.\n\n\n## Available data\n\nData has been downloaded and prepared for you from [GEO GSE152495](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE152495). \n\nIn order to download the data, run:\n\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\nwget https://single-cell-transcriptomics.s3.eu-central-1.amazonaws.com/projects/data/project2.tar.gz\ntar -xzvf project2.tar.gz\n```\n:::\n\n\n\n\n\nAfter extracting, a directory `project2` appears with the following format:\n\n```\n.\n├── data\n│   ├── Female_Cocaine_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Cocaine_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Sucrose_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Sucrose_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Cocaine_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Cocaine_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Sucrose_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   └── Male_Sucrose_2\n│       ├── barcodes.tsv.gz\n│       ├── features.tsv.gz\n│       └── matrix.mtx.gz\n└── paper.pdf\n\n9 directories, 25 files\n```\n\nShowing us that we have two replicates per treatment, and two treatments:\n\n- Male_Sucrose: controls\n- Female_Sucrose: controls\n- Male_Cocaine: treatments\n- Female_Cocaine: treatments\n\nNow create a new project in the `project2` directory (Project (None) > New Project ...), and create Seurat object from the count matrices:\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Seurat)\n\n# vector of paths to all sample directories\ndatadirs <- list.files(path = \"data\", full.names = TRUE)\n\n# get the sample names\n# replace underscores with hyphen to correctly extract sample names later on\nnames(datadirs) <- basename(datadirs) |> gsub(\"_\", \"-\", x = _)\n\n# for now, we take only one sample per treatment\ndatadirs <- datadirs[c(\"Female-Cocaine-1\", \"Female-Sucrose-1\",\n                       \"Male-Cocaine-1\", \"Male-Sucrose-1\")]\n\n# create a large sparse matrix from all count data\nsparse_matrix <- Seurat::Read10X(data.dir = datadirs)\n\n# create a seurat object from sparse matrix\nseu <- Seurat::CreateSeuratObject(counts = sparse_matrix,\n                                  project = \"CocaineStudy\")\n```\n:::\n\n\n\n\n\n::: {.callout-important}\n## Project exercise\n\nWith this dataset, go through the steps we have performed during the course, and try to reproduce the results provided in the paper. Pay specific attention to quality control, clustering and annotation. \n:::\n\n## Tips\n\n- For mitochondrial genes and ribosomol genes you can use the following patterns: `\"^mt:\"` and `\"^Rp[SL]\"`. \n\n- Work iterative; meaning that based on results of an analyis, adjust the previous analysis. For example, if clustering is not according to cell types, try to adjust the number of components or the resolution. \n\n- Please read the methods section of the paper.\n\n- If the code for data analysis is available, try to adapt it (for specific parameters).\n\n- Check the supplementary figures.\n\n- Try to understand if they used some other tools for the data analysis.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}