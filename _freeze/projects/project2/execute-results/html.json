{
  "hash": "1053570b0810772d35d393a06a3660f0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Project 2\"\nexecute:\n    eval: false\nproject:\n    execute-dir: project\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\nProject 2 focuses on a single-cell sequencing study of the Drosophila brain following acute cocaine exposure. Flies were exposed to cocaine, which impaired locomotor activity and increased the incidence of seizures and compulsive grooming. To investigate the specific cell populations responding to cocaine, single-cell transcriptional responses were analyzed in duplicate samples of flies that consumed sucrose or sucrose supplemented with cocaine. The study utilized the 10x Genomics Chromium platform for single-cell RNA sequencing.\n\nUnsupervised clustering of transcriptional profiles from 86,224 cells revealed 36 distinct clusters, representing all major cell types (neuronal and glial) and neurotransmitter types from most brain regions. Differential expression analysis within individual clusters indicated cluster-specific responses to cocaine, with Kenyon cells of the mushroom bodies and glia showing particularly large transcriptional changes. The study highlighted profound sexual dimorphism in brain transcriptional responses to cocaine, with males exhibiting more pronounced changes than females.\n\nCluster-specific coexpression networks and global interaction networks revealed diverse cellular processes affected by acute cocaine exposure, providing an atlas of sexually dimorphic cocaine-modulated gene expression in the Drosophila brain.\n\n\n## Available data\n\nData has been downloaded and prepared for you from [GEO GSE152495](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE152495). \n\nIn order to download the data, run:\n\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\nwget GSE152495.tar.gz\ntar -xzcvf GSE152495.tar.gz\n```\n:::\n\n\n\n\n\nAfter extracting, you would see the following format:\n\n```\nGSE152495/\n├── data\n│   ├── Female_Cocaine_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Cocaine_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Sucrose_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Female_Sucrose_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Cocaine_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Cocaine_2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── Male_Sucrose_1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   └── Male_Sucrose_2\n│       ├── barcodes.tsv.gz\n│       ├── features.tsv.gz\n│       └── matrix.mtx.gz\n└── paper.pdf\n```\n\nShowing us that we have two replicates per treatment, and two treatments:\n\n- Male_Sucrose: controls\n- Female_Sucrose: controls\n- Male_Cocaine: treatments\n- Female_Cocaine: treatments\n\nUse the following code to read the data files in R, and create a combined Seurat object:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Seurat)\n\n# Function to read the data from the files and create a Seurat object\nread_10x_data <- function(sample_path) {\n  # Read data\n  data <- Read10X(sample_path)\n  barcodes <- readLines(paste0(sample_path, \"/barcodes.tsv.gz\"))\n  features <- read.table(paste0(sample_path, \"/features.tsv.gz\"))\n\n  # Create Seurat object\n  seurat_object <- Seurat::CreateSeuratObject(data)\n  seurat_object <- AddMetaData(seurat_object,\n    metadata = barcodes,\n    col.name = \"barcodes\"\n  )\n  seurat_object <- AddMetaData(seurat_object,\n    metadata = features$V2,\n    col.name = \"features\"\n  )\n\n  return(seurat_object)\n}\n\n# Data directory\ndata_dir <- \"data/project2/GSE152495/data\"\n\n# Read data for each sample and combine into a single Seurat object\nsamples <- basename(list.dirs(path = data_dir, full.names = T)[-1])\n\nseurat_objects <- lapply(samples, function(sample) {\n  read_10x_data(sample_path = file.path(data_dir, sample))\n})\n\ncombined_seurat <- merge(seurat_objects[[1]],\n  y = seurat_objects[-1],\n  add.cell.ids = samples, project = \"CocaineStudy\"\n)\n\ncombined_seurat@meta.data$orig.ident <- sapply(\n  rownames(combined_seurat@meta.data),\n  function(x) {\n    paste(strsplit(x = x, split = \"_\")[[1]][1:3], stylercollapse = \"_\")\n  }\n)\n```\n:::\n\n\n\n\n\n::: {.callout-important}\n## Project exercise\n\nwith this dataset, go through the steps we have performed during the course, and try to reproduce the results provided in the paper. Pay specific attention to quality control, clustering and annotation. \n:::\n\n## Tips\n\n- For mitochondrial genes, ribosomol genes and hemoglobin genes you can use the following table:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(biomaRt)\n\n# Connect to Ensembl's FlyBase dataset\nensembl <- useMart(\"ensembl\", dataset = \"dmelanogaster_gene_ensembl\")\n\n# Define attributes to fetch\nattributes <- c(\n  \"flybase_annot_id\", \"ensembl_gene_id\", \"flybase_gene_id\",\n  \"external_gene_name\", \"flybasename_gene\", \"description\"\n)\n\n# Get data\ngene_table <- getBM(attributes = attributes, mart = ensembl)\n\n# Print the first few rows\nhead(gene_table)\n```\n:::\n\n\n\n\n- Work iterative; meaning that based on results of an analyis, adjust the previous analysis. For example, if clustering is not according to cell types, try to adjust the number of components or the resolution. \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}