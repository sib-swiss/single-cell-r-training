{
  "hash": "0907e7b35091d58594604e00f24df9b6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Project 3\"\nexecute:\n    eval: false\nproject:\n    execute-dir: project\neditor_options: \n  chunk_output_type: console\n---\n\n\n\n\nProject 3 focuses on understanding the role of type I interferon (IFN-I) responsiveness in shaping immune outcomes following PD1 blockade therapy. Type I interferons play a dual role in cancer immunotherapy, promoting both anti-tumor immunity and immune suppression through T cell exhaustion. To investigate how pre-existing IFN-I responses influence therapeutic success, this study utilizes scRNA-seq data from **healthy donors and 8 treated patients** to analyze transcriptional responses in immune cells.  \n\nUnsupervised clustering of transcriptional profiles revealed distinct immune cell populations and IFN-I-induced responses. Differences in IFN-I responsiveness were linked to immune cell states and transcriptional programs that influence therapy outcomes. Patients with lower pre-therapy IFN-I responsiveness in CD4 and CD8 effector T cells (Teff cells) exhibited transcriptional signatures associated with improved immune function, whereas highly responsive Teff cells displayed gene expression patterns linked to immune dysfunction and therapy resistance.  \n\nFurther analysis identified epigenetically imprinted IFN-I response states that predefine immune reactivity to therapy. Coexpression and network analyses demonstrated that IFN-I responsiveness influences functional T cell programs and systemic immune coordination. This study provides insights into how pre-existing immune states impact therapeutic success and highlights transcriptional markers that could be used to predict patient outcomes in PD1 blockade immunotherapy.  \n\n## Available data\n\nData has been downloaded and prepared for you from [GEO GSE199994](https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE199994). \n\nIn order to download the data, run:\n\n\n\n::: {.cell}\n\n```{.bash .cell-code}\nwget https://single-cell-transcriptomics.s3.eu-central-1.amazonaws.com/projects/data/project3.tar.gz\ntar -xzcvf project3.tar.gz\n```\n:::\n\n\n\n```\nGSE199994/\n├── data\n│   ├── HD1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── HD2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P1\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P2\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P3\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P4\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P5\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P6\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   ├── P7\n│   │   ├── barcodes.tsv.gz\n│   │   ├── features.tsv.gz\n│   │   └── matrix.mtx.gz\n│   └── P8\n│       ├── barcodes.tsv.gz\n│       ├── features.tsv.gz\n│       └── matrix.mtx.gz\n└── paper.pdf\n```\n\nShowing us that we have two replicates of healthy donors and 8 of treatment:\n\n- HD: controls\n- P: treatments\n\n\nUse the following code to read the data files in R, and create a combined Seurat object:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(Seurat)\n\n# Function to read the data from the files and create a Seurat object\nread_10x_data <- function(sample_path) {\n  # Read data\n  data <- Read10X(sample_path)\n  barcodes <- readLines(paste0(sample_path, \"/barcodes.tsv.gz\"))\n  features <- read.delim(paste0(sample_path, \"/features.tsv.gz\"), header = FALSE)\n\n  # Create Seurat object\n  seurat_object <- Seurat::CreateSeuratObject(data)\n  seurat_object <- AddMetaData(seurat_object, metadata = barcodes, \n                               col.name = \"barcodes\")\n  seurat_object <- AddMetaData(seurat_object, metadata = features$V2,\n                               col.name = \"features\")\n\n  return(seurat_object)\n}\n\n# Data directory\ndata_dir <- \"data/project3/GSE199994/data\"\n\n# Read data for each sample and combine into a single Seurat object\nsamples <- basename(list.dirs(path = data_dir, full.names = T)[-1])\n\nseurat_objects <- lapply(samples, function(sample) \n  read_10x_data(sample_path = file.path(data_dir, sample)))\n\ncombined_seurat <- merge(seurat_objects[[1]],\n  y = seurat_objects[-1],\n  add.cell.ids = samples, project = \"InterferonStudy\"\n)\n\ncombined_seurat@meta.data$orig.ident <- sapply(\n  rownames(combined_seurat@meta.data),\n  function(x) {\n    paste(strsplit(x = x, split = \"_\")[[1]][1:3], collapse = \"_\")\n  }\n)\n```\n:::\n\n\n\n\n::: {.callout-important}\n## Project exercise\n\nwith this dataset, go through the steps we have performed during the course, and try to reproduce the results provided in the paper. Pay specific attention to quality control, clustering and annotation. \n:::\n\n## Tips\n\n- For mitochondrial genes, ribosomol genes and hemoglobin genes you can use the following patterns: `\"^MT-\"`, `\"^RP[SL]\"` and `\"^HB[^(P)]\"`. \n- Work iterative; meaning that based on results of an analyis, adjust the previous analysis. For example, if clustering is not according to cell types, try to adjust the number of components or the resolution. \n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}